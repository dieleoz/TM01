<!DOCTYPE html>
<html lang="es">

<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WBS Presupuestal - TM01 Troncal Magdalena</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="css/presupuesto.css">
    <link rel="stylesheet" href="css/tm01-design-system.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <button class="back-btn" onclick="window.location.href='WBS_Menu_Principal.html'">‚Üê Volver al Men√∫</button>
            <h1>üí∞ WBS PRESUPUESTAL</h1>
            <p>TM01 Troncal Magdalena | C√°lculos AIU/IVA y Exportaci√≥n</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="aplicarFiltros()">üîç Aplicar</button>
            <button class="btn" onclick="limpiarFiltros()">üóëÔ∏è Limpiar</button>
            <button class="btn btn-success" onclick="exportarExcel()">üìä Exportar Excel</button>
            <button class="btn" style="background:#17a2b8;color:#fff;" onclick="exportarDesgloseAIU()">üìã Ver Desglose
                AIU</button>
            <button class="btn" style="background:#ffc107;color:#212529;" onclick="generarActaObra()">üßæ Ver Acta de
                Obra</button>
            <div class="filter-group">
                <label for="fSistema">Sistema:</label>
                <select id="fSistema"></select>
                <label for="fUF">UF:</label>
                <select id="fUF"></select>
                <label for="fBuscar">Buscar:</label>
                <input id="fBuscar" type="text" placeholder="C√≥digo o descripci√≥n" oninput="aplicarFiltros()" />
            </div>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="label">Total USD</div>
                <div class="value" id="statUSD">-</div>
            </div>
            <div class="stat">
                <div class="label">Total COP</div>
                <div class="value" id="statCOP">-</div>
            </div>
            <div class="stat">
                <div class="label">AIU (33% solo OBRA)</div>
                <div class="value" id="statAIU">-</div>
            </div>
            <div class="stat">
                <div class="label">IVA (SUM+SERV+Util OBRA)</div>
                <div class="value" id="statIVA">-</div>
            </div>
            <div class="stat">
                <div class="label">Items</div>
                <div class="value" id="statItems">-</div>
            </div>
            <div class="stat">
                <div class="label"># SUM</div>
                <div class="value" id="statSum">-</div>
            </div>
            <div class="stat">
                <div class="label"># OBRA</div>
                <div class="value" id="statObra">-</div>
            </div>
            <div class="stat">
                <div class="label"># SERV</div>
                <div class="value" id="statServ">-</div>
            </div>
        </div>

        <div class="table-container">
            <table id="tablaPresupuesto">
                <thead>
                    <tr>
                        <th>√çtem</th>
                        <th>Descripci√≥n</th>
                        <th>Sistema</th>
                        <th class="right">Cant.</th>
                        <th>Und</th>
                        <th>Tipo</th>
                        <th>UF</th>
                        <th class="right">VU USD</th>
                        <th class="right">Total USD</th>
                        <th class="right">VU COP</th>
                        <th class="right">Total COP</th>
                    </tr>
                </thead>
                <tbody id="tbodyPresupuesto">
                    <tr>
                        <td colspan="11" style="text-align:center;color:#6c757d; padding: 18px;">‚è≥ Cargando datos
                            presupuestales...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="table-container" id="desgloseContainer">
            <h3 style="margin:6px 0 10px;color:#1e3c72;">üìä Desglose Presupuestal por Cap√≠tulos</h3>
            <table>
                <thead>
                    <tr>
                        <th>Cap√≠tulo</th>
                        <th class="right">Suministros (COP)</th>
                        <th class="right">Obra Civil (COP)</th>
                        <th class="right">Servicios (COP)</th>
                        <th class="right">Costo Directo (COP)</th>
                        <th class="right">AIU 33% (COP)</th>
                        <th class="right">IVA (COP)</th>
                        <th class="right">Total (COP)</th>
                        <th class="right">Total (USD)</th>
                    </tr>
                </thead>
                <tbody id="tbodyDesglose"></tbody>
            </table>
        </div>

        <div class="footer">
            √öltima actualizaci√≥n: <span id="fechaActual"></span>
        </div>
    </div>

    <!-- Librer√≠as Externas -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Datos (Generados y Est√°ticos) -->
    <script src="data/uf_pk_map.js"></script>
    <script src="data/tm01_master_data.js?v=20260122d"></script>
    <script src="datos_wbs_TM01_items.js?v=20260122d"></script>

    <!-- M√≥dulos de la Aplicaci√≥n -->
    <script src="js/presupuesto-calcs.js?v=20260122d"></script>
    <script src="js/presupuesto-export.js?v=20260122d"></script>
    <script src="js/presupuesto-main.js?v=20260122d"></script>

</body>

</html>