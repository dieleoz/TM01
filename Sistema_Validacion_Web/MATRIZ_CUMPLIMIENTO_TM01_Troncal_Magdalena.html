<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matriz Cumplimiento TM01 - Troncal Magdalena</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .alert-critical {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .alert-critical h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .alert-critical p {
            color: #856404;
            margin: 5px 0;
        }
        
        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(23, 162, 184, 0.4);
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-left: auto;
        }
        
        .filter-group select {
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            background: white;
        }
        
        .table-container {
            padding: 20px 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        th {
            background: #2c3e50;
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid #dee2e6;
            font-size: 0.9em;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }
        
        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .badge-secondary {
            background: #e2e3e5;
            color: #383d41;
        }
        
        .stats {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card p {
            font-size: 24px;
            font-weight: 700;
            color: #212529;
        }
        
        .icon {
            width: 18px;
            height: 18px;
        }
        
        .action-btn {
            padding: 4px 8px;
            font-size: 0.8em;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        
        .action-btn:hover {
            background: #0056b3;
        }
        
        .cumplimiento-ok {
            background: #d4edda;
            color: #155724;
        }
        
        .cumplimiento-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .cumplimiento-error {
            background: #f8d7da;
            color: #721c24;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-group {
                margin-left: 0;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã MATRIZ CUMPLIMIENTO CONTRACTUAL VS T√âCNICO</h1>
            <p>TM01 - Troncal Magdalena | APP Puerto Salgar - Barrancabermeja | Validaci√≥n Externa | Versi√≥n 1.0</p>
            <div class="alert-critical">
                <h3>‚ö†Ô∏è VALIDACI√ìN CR√çTICA CONTRACTUAL</h3>
                <p><strong>Objetivo:</strong> Verificar cumplimiento de especificaciones t√©cnicas vs obligaciones contractuales</p>
                <p><strong>Alcance:</strong> Todos los sistemas ITS del proyecto TM01</p>
                <p><strong>Responsable:</strong> Administrador Contractual EPC</p>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-success" onclick="exportarExcel()">
                <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"/>
                </svg>
                Exportar a Excel
            </button>
            
            <button class="btn btn-primary" onclick="validarCumplimiento()">
                <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Validar Cumplimiento
            </button>
            
            <button class="btn btn-warning" onclick="generarReporteCumplimiento()">
                <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"/>
                </svg>
                Generar Reporte
            </button>
            
            <button class="btn btn-danger" onclick="identificarDiscrepancias()">
                <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                </svg>
                Identificar Discrepancias
            </button>
            
            <button class="btn btn-info" onclick="imprimirPDF()">
                <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd"/>
                </svg>
                Imprimir PDF
            </button>
            
            <div class="filter-group">
                <label for="filtroCumplimiento">Filtrar por cumplimiento:</label>
                <select id="filtroCumplimiento" onchange="filtrarPorCumplimiento()">
                    <option value="TODOS">Todos</option>
                    <option value="CUMPLE">Cumple</option>
                    <option value="PARCIAL">Cumplimiento Parcial</option>
                    <option value="NO_CUMPLE">No Cumple</option>
                    <option value="PENDIENTE">Pendiente</option>
                </select>
            </div>
        </div>
        
        <div class="table-container">
            <table id="cumplimientoTable">
                <thead>
                    <tr>
                        <th style="width: 100px;">SISTEMA</th>
                        <th style="width: 200px;">ESPECIFICACI√ìN T√âCNICA</th>
                        <th style="width: 150px;">OBLIGACI√ìN CONTRACTUAL</th>
                        <th style="width: 100px;">CANTIDAD T√âCNICA</th>
                        <th style="width: 100px;">CANTIDAD CONTRACTUAL</th>
                        <th style="width: 120px;">CUMPLIMIENTO</th>
                        <th style="width: 150px;">JUSTIFICACI√ìN</th>
                        <th style="width: 120px;">ACCI√ìN REQUERIDA</th>
                        <th style="width: 100px;">RESPONSABLE</th>
                        <th style="width: 100px;">ACCI√ìN</th>
                    </tr>
                </thead>
                <tbody id="cumplimientoBody">
                </tbody>
            </table>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h3>Total Especificaciones</h3>
                <p id="totalEspecificaciones">32</p>
            </div>
            <div class="stat-card">
                <h3>Cumplimiento Total</h3>
                <p id="cumplimientoTotal">28</p>
            </div>
            <div class="stat-card">
                <h3>Cumplimiento Parcial</h3>
                <p id="cumplimientoParcial">3</p>
            </div>
            <div class="stat-card">
                <h3>No Cumple</h3>
                <p id="noCumple">1</p>
            </div>
        </div>
    </div>

    <script>
        // Datos de cumplimiento contractual vs t√©cnico TM01
        const cumplimientoData = [
            // SISTEMA SOS
            {sistema: "SOS", especificacion: "Postes SOS principales", obligacion: "AT1 Cap. 3 - Criterio 1km", cantidadTecnica: "87", cantidadContractual: "87", cumplimiento: "CUMPLE", justificacion: "Criterio 1km aplicado correctamente", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "SOS", especificacion: "SOS #88 CCO", obligacion: "Conexi√≥n CCO La Lizama", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Conexi√≥n CCO justificada", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "SOS", especificacion: "Cimentaciones SOS", obligacion: "Estructura soporte", cantidadTecnica: "88", cantidadContractual: "88", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "SOS", especificacion: "Instalaci√≥n SOS", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "88", cantidadContractual: "88", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA ETD/RADAR
            {sistema: "ETD", especificacion: "ETD principales", obligacion: "AT1 Cap. 3 - Criterio 15km", cantidadTecnica: "14", cantidadContractual: "14", cumplimiento: "CUMPLE", justificacion: "Criterio 15km aplicado correctamente", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "ETD", especificacion: "RADAR ANPR", obligacion: "Control vehicular en peajes", cantidadTecnica: "2", cantidadContractual: "2", cumplimiento: "CUMPLE", justificacion: "Control vehicular requerido", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "ETD", especificacion: "Cimentaciones ETD/RADAR", obligacion: "Estructura soporte", cantidadTecnica: "16", cantidadContractual: "16", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "ETD", especificacion: "Instalaci√≥n ETD/RADAR", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "16", cantidadContractual: "16", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA CCTV
            {sistema: "CCTV", especificacion: "C√°maras PAN", obligacion: "Solo en peajes", cantidadTecnica: "30", cantidadContractual: "30", cumplimiento: "CUMPLE", justificacion: "CCTV solo en peajes seg√∫n contrato", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "CCTV", especificacion: "C√°maras fijas", obligacion: "Supervisi√≥n CCO y estaciones", cantidadTecnica: "15", cantidadContractual: "15", cumplimiento: "CUMPLE", justificacion: "Supervisi√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "CCTV", especificacion: "Cimentaciones CCTV", obligacion: "Estructura soporte", cantidadTecnica: "30", cantidadContractual: "30", cumplimiento: "CUMPLE", justificacion: "Estructura soporte optimizada", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "CCTV", especificacion: "Instalaci√≥n CCTV", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "30", cantidadContractual: "30", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n optimizada", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA PMV
            {sistema: "PMV", especificacion: "Paneles mensaje variable", obligacion: "AT1 Cap. 3 - Criterio 20km", cantidadTecnica: "12", cantidadContractual: "12", cumplimiento: "CUMPLE", justificacion: "Criterio 20km aplicado correctamente", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "PMV", especificacion: "Cimentaciones PMV", obligacion: "Estructura soporte", cantidadTecnica: "12", cantidadContractual: "12", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "PMV", especificacion: "Instalaci√≥n PMV", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "12", cantidadContractual: "12", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA METEOROL√ìGICO
            {sistema: "METEO", especificacion: "Estaci√≥n Peaje 1", obligacion: "NTC 5660", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "NTC 5660 aplicada correctamente", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "METEO", especificacion: "Estaci√≥n Peaje 2", obligacion: "NTC 5660", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "NTC 5660 aplicada correctamente", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "METEO", especificacion: "Estaci√≥n CCO", obligacion: "Supervisi√≥n meteorol√≥gica", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Supervisi√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "METEO", especificacion: "Cimentaciones Meteo", obligacion: "Estructura soporte", cantidadTecnica: "3", cantidadContractual: "3", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "METEO", especificacion: "Instalaci√≥n Meteo", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "3", cantidadContractual: "3", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA WIM
            {sistema: "WIM", especificacion: "Sistema WIM optimizado", obligacion: "PAT optimizado", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "PAT optimizado aplicado", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "WIM", especificacion: "Cimentaciones WIM", obligacion: "Estructura soporte", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "WIM", especificacion: "Instalaci√≥n WIM", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // SISTEMA FIBRA √ìPTICA
            {sistema: "FO", especificacion: "Cable FO 48 fibras", obligacion: "Red troncal", cantidadTecnica: "293", cantidadContractual: "293", cumplimiento: "CUMPLE", justificacion: "Red troncal requerida", accionRequerida: "Ninguna", responsable: "Telecom", accion: "VALIDAR"},
            {sistema: "FO", especificacion: "Cajas empalme", obligacion: "Distribuci√≥n cada 300m", cantidadTecnica: "977", cantidadContractual: "977", cumplimiento: "CUMPLE", justificacion: "Distribuci√≥n requerida", accionRequerida: "Ninguna", responsable: "Telecom", accion: "VALIDAR"},
            {sistema: "FO", especificacion: "Tendido FO", obligacion: "Instalaci√≥n", cantidadTecnica: "293", cantidadContractual: "293", cumplimiento: "CUMPLE", justificacion: "Instalaci√≥n requerida", accionRequerida: "Ninguna", responsable: "Telecom", accion: "VALIDAR"},
            {sistema: "FO", especificacion: "Empalmes FO", obligacion: "Fusi√≥n y certificaci√≥n", cantidadTecnica: "977", cantidadContractual: "977", cumplimiento: "CUMPLE", justificacion: "Fusi√≥n y certificaci√≥n requerida", accionRequerida: "Ninguna", responsable: "Telecom", accion: "VALIDAR"},

            // CENTRO DE CONTROL OPERACIONAL
            {sistema: "CCO", especificacion: "Edificio CCO", obligacion: "AT1 Cap. 3", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "AT1 Cap. 3 aplicado", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "CCO", especificacion: "Sistemas SCADA", obligacion: "Supervisi√≥n", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Supervisi√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},
            {sistema: "CCO", especificacion: "Cimentaciones CCO", obligacion: "Estructura soporte", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Estructura soporte requerida", accionRequerida: "Ninguna", responsable: "Ing. Civil", accion: "VALIDAR"},
            {sistema: "CCO", especificacion: "Instalaci√≥n CCO", obligacion: "Montaje y configuraci√≥n", cantidadTecnica: "1", cantidadContractual: "1", cumplimiento: "CUMPLE", justificacion: "Montaje y configuraci√≥n requerida", accionRequerida: "Ninguna", responsable: "Ing. Sistemas", accion: "VALIDAR"},

            // DISCREPANCIAS IDENTIFICADAS
            {sistema: "FO", especificacion: "Regla 10km L2-L2", obligacion: "Arquitectura L2/L3", cantidadTecnica: "29", cantidadContractual: "30", cumplimiento: "PARCIAL", justificacion: "Regla 10km vs realidad del terreno", accionRequerida: "Ajustar arquitectura", responsable: "Telecom", accion: "REVISAR"},
            {sistema: "SOS", especificacion: "Criterio 1km vs terreno", obligacion: "AT1 Cap. 3", cantidadTecnica: "87", cantidadContractual: "88", cumplimiento: "PARCIAL", justificacion: "Criterio 1km vs realidad del terreno", accionRequerida: "Ajustar ubicaciones", responsable: "Ing. Sistemas", accion: "REVISAR"},
            {sistema: "ETD", especificacion: "Criterio 15km vs terreno", obligacion: "AT1 Cap. 3", cantidadTecnica: "14", cantidadContractual: "15", cumplimiento: "PARCIAL", justificacion: "Criterio 15km vs realidad del terreno", accionRequerida: "Ajustar ubicaciones", responsable: "Ing. Sistemas", accion: "REVISAR"},
            {sistema: "PMV", especificacion: "Criterio 20km vs terreno", obligacion: "AT1 Cap. 3", cantidadTecnica: "12", cantidadContractual: "13", cumplimiento: "NO_CUMPLE", justificacion: "Criterio 20km vs realidad del terreno", accionRequerida: "Ajustar ubicaciones", responsable: "Ing. Sistemas", accion: "REVISAR"}
        ];

        // Funci√≥n para renderizar la tabla
        function renderTable() {
            const tbody = document.getElementById('cumplimientoBody');
            let html = '';

            cumplimientoData.forEach(item => {
                const cumplimientoBadge = getCumplimientoBadge(item.cumplimiento);
                const actionButton = getActionButton(item.accion, item.sistema);

                html += `
                    <tr>
                        <td><span class="badge badge-info">${item.sistema}</span></td>
                        <td>${item.especificacion}</td>
                        <td>${item.obligacion}</td>
                        <td style="text-align: center; font-weight: bold;">${item.cantidadTecnica}</td>
                        <td style="text-align: center; font-weight: bold;">${item.cantidadContractual}</td>
                        <td>${cumplimientoBadge}</td>
                        <td>${item.justificacion}</td>
                        <td>${item.accionRequerida}</td>
                        <td>${item.responsable}</td>
                        <td>${actionButton}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // Funci√≥n para obtener badge de cumplimiento
        function getCumplimientoBadge(cumplimiento) {
            switch(cumplimiento) {
                case 'CUMPLE':
                    return '<span class="badge badge-success">‚úÖ CUMPLE</span>';
                case 'PARCIAL':
                    return '<span class="badge badge-warning">‚ö†Ô∏è PARCIAL</span>';
                case 'NO_CUMPLE':
                    return '<span class="badge badge-danger">‚ùå NO CUMPLE</span>';
                case 'PENDIENTE':
                    return '<span class="badge badge-secondary">‚è≥ PENDIENTE</span>';
                default:
                    return '<span class="badge badge-secondary">N/A</span>';
            }
        }

        // Funci√≥n para obtener bot√≥n de acci√≥n
        function getActionButton(accion, sistema) {
            return `<button class="action-btn" onclick="revisarCumplimiento('${sistema}', '${accion}')">${accion}</button>`;
        }

        // Funci√≥n para filtrar por cumplimiento
        function filtrarPorCumplimiento() {
            const filtro = document.getElementById('filtroCumplimiento').value;
            const tbody = document.getElementById('cumplimientoBody');
            let html = '';

            const datosFiltrados = filtro === 'TODOS' ? cumplimientoData : cumplimientoData.filter(item => item.cumplimiento === filtro);

            datosFiltrados.forEach(item => {
                const cumplimientoBadge = getCumplimientoBadge(item.cumplimiento);
                const actionButton = getActionButton(item.accion, item.sistema);

                html += `
                    <tr>
                        <td><span class="badge badge-info">${item.sistema}</span></td>
                        <td>${item.especificacion}</td>
                        <td>${item.obligacion}</td>
                        <td style="text-align: center; font-weight: bold;">${item.cantidadTecnica}</td>
                        <td style="text-align: center; font-weight: bold;">${item.cantidadContractual}</td>
                        <td>${cumplimientoBadge}</td>
                        <td>${item.justificacion}</td>
                        <td>${item.accionRequerida}</td>
                        <td>${item.responsable}</td>
                        <td>${actionButton}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // Funci√≥n para revisar cumplimiento
        function revisarCumplimiento(sistema, accion) {
            alert(`üîç Revisando cumplimiento del sistema ${sistema}...\n\nAcci√≥n: ${accion}\n\nEsta funci√≥n abrir√° el documento t√©cnico correspondiente para revisi√≥n detallada.`);
        }

        // Funci√≥n para validar cumplimiento
        function validarCumplimiento() {
            console.log('=== VALIDACI√ìN CUMPLIMIENTO TM01 ===');
            const cumple = cumplimientoData.filter(item => item.cumplimiento === 'CUMPLE').length;
            const parcial = cumplimientoData.filter(item => item.cumplimiento === 'PARCIAL').length;
            const noCumple = cumplimientoData.filter(item => item.cumplimiento === 'NO_CUMPLE').length;
            const total = cumplimientoData.length;
            
            console.log('Total especificaciones:', total);
            console.log('Cumple:', cumple);
            console.log('Cumplimiento parcial:', parcial);
            console.log('No cumple:', noCumple);
            console.log('Porcentaje cumplimiento:', ((cumple / total) * 100).toFixed(1) + '%');
            console.log('=====================================');
            
            alert(`‚úÖ Validaci√≥n de cumplimiento completada.\n\nTotal: ${total}\nCumple: ${cumple}\nParcial: ${parcial}\nNo cumple: ${noCumple}\n\nPorcentaje: ${((cumple / total) * 100).toFixed(1)}%\n\nVer consola para detalles.`);
        }

        // Funci√≥n para generar reporte de cumplimiento
        function generarReporteCumplimiento() {
            const reporte = `
=== REPORTE CUMPLIMIENTO CONTRACTUAL TM01 ===
PROYECTO: APP Puerto Salgar - Barrancabermeja
FECHA: 22 de Octubre de 2025
SISTEMA: Validaci√≥n Contractual vs T√©cnico
ESTADO: Validaci√≥n Externa

RESUMEN EJECUTIVO:
- Total especificaciones evaluadas: ${cumplimientoData.length}
- Cumplimiento total: ${cumplimientoData.filter(item => item.cumplimiento === 'CUMPLE').length}
- Cumplimiento parcial: ${cumplimientoData.filter(item => item.cumplimiento === 'PARCIAL').length}
- No cumple: ${cumplimientoData.filter(item => item.cumplimiento === 'NO_CUMPLE').length}

DISCREPANCIAS IDENTIFICADAS:
1. Regla 10km L2-L2 vs realidad del terreno
2. Criterio 1km SOS vs realidad del terreno
3. Criterio 15km ETD vs realidad del terreno
4. Criterio 20km PMV vs realidad del terreno

ACCIONES REQUERIDAS:
1. Ajustar arquitectura L2/L3 seg√∫n realidad del terreno
2. Ajustar ubicaciones SOS seg√∫n realidad del terreno
3. Ajustar ubicaciones ETD seg√∫n realidad del terreno
4. Ajustar ubicaciones PMV seg√∫n realidad del terreno

RESPONSABLES:
- Telecom: Arquitectura L2/L3
- Ing. Sistemas: Ubicaciones SOS, ETD, PMV
- Ing. Civil: Cimentaciones

PR√ìXIMOS PASOS:
1. Revisar discrepancias con Interventor√≠a
2. Ajustar especificaciones t√©cnicas
3. Validar con ANI
4. Preparar para construcci√≥n

================================================
            `;
            
            console.log(reporte);
            alert('üìã Reporte de cumplimiento generado. Ver consola para detalles completos.');
        }

        // Funci√≥n para identificar discrepancias
        function identificarDiscrepancias() {
            const discrepancias = cumplimientoData.filter(item => item.cumplimiento !== 'CUMPLE');
            
            console.log('=== DISCREPANCIAS IDENTIFICADAS TM01 ===');
            discrepancias.forEach((item, index) => {
                console.log(`${index + 1}. ${item.sistema} - ${item.especificacion}`);
                console.log(`   Cumplimiento: ${item.cumplimiento}`);
                console.log(`   Justificaci√≥n: ${item.justificacion}`);
                console.log(`   Acci√≥n requerida: ${item.accionRequerida}`);
                console.log(`   Responsable: ${item.responsable}`);
                console.log('');
            });
            console.log('=========================================');
            
            alert(`üîç Discrepancias identificadas: ${discrepancias.length}\n\nVer consola para detalles completos.`);
        }

        // Funci√≥n para exportar a Excel
        function exportarExcel() {
            try {
                const ws = XLSX.utils.json_to_sheet(cumplimientoData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Cumplimiento TM01");
                
                XLSX.writeFile(wb, "Matriz_Cumplimiento_TM01_Troncal_Magdalena.xlsx");
                
                alert('‚úÖ Archivo Excel exportado exitosamente: Matriz_Cumplimiento_TM01_Troncal_Magdalena.xlsx');
            } catch (error) {
                console.error('Error al exportar Excel:', error);
                alert('‚ùå Error al exportar Excel. Ver consola para detalles.');
            }
        }

        // Funci√≥n para imprimir PDF
        function imprimirPDF() {
            window.print();
        }

        // Inicializar la tabla al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            renderTable();
            
            // Actualizar estad√≠sticas
            document.getElementById('totalEspecificaciones').textContent = cumplimientoData.length;
            document.getElementById('cumplimientoTotal').textContent = cumplimientoData.filter(item => item.cumplimiento === 'CUMPLE').length;
            document.getElementById('cumplimientoParcial').textContent = cumplimientoData.filter(item => item.cumplimiento === 'PARCIAL').length;
            document.getElementById('noCumple').textContent = cumplimientoData.filter(item => item.cumplimiento === 'NO_CUMPLE').length;
            
            // Validar cumplimiento despu√©s de cargar
            setTimeout(() => {
                validarCumplimiento();
            }, 1000);
        });
    </script>
</body>
</html>
