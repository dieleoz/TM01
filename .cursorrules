# CURSOR RULES PARA PROYECTO TM01 TRONCAL MAGDALENA
# Archivo: .cursorrules
# Prop√≥sito: Detecci√≥n autom√°tica de DTs y propagaci√≥n en 4 niveles
# Fecha: 24 de octubre de 2025
# Versi√≥n: 1.0

## CONTEXTO DEL PROYECTO
Este es un proyecto de ingenier√≠a EPC para TM01 Troncal Magdalena (293 km) con Sistema de Validaci√≥n Web con Arquitectura Din√°mica de 4 Capas implementado.

## ARQUITECTURA DEL SISTEMA
- **Capa 1**: Fuentes de Verdad (Documentos base inmutables)
- **Capa 2**: Transformaci√≥n (Scripts PowerShell de sincronizaci√≥n)
- **Capa 3**: Datos Intermedios (Estructuras din√°micas generadas)
- **Capa 4**: Visualizaci√≥n (Interfaces HTML interactivas)

## DETECCI√ìN AUTOM√ÅTICA DE DECISIONES T√âCNICAS (DTs)

### Patrones de Detecci√≥n
Cuando detectes cualquiera de estos patrones, genera autom√°ticamente una DT:

1. **Cambios en cantidades de equipos**:
   - "cambiar de X a Y unidades"
   - "ajustar cantidad de [equipo]"
   - "modificar n√∫mero de [sistema]"

2. **Cambios en especificaciones t√©cnicas**:
   - "actualizar especificaci√≥n de [equipo]"
   - "cambiar modelo de [sistema]"
   - "modificar criterio t√©cnico"

3. **Cambios en ubicaciones/coordenadas**:
   - "mover [equipo] a PK X"
   - "cambiar ubicaci√≥n de [sistema]"
   - "ajustar coordenadas"

4. **Cambios en presupuesto**:
   - "actualizar costo de [item]"
   - "modificar presupuesto de [sistema]"
   - "ajustar valores unitarios"

### Formato de DT Autom√°tica
Cuando generes una DT, usa este formato y gu√°rdala en la carpeta `VII. Documentos Transversales/DTs/`:

```markdown
# DT-TM01-[SISTEMA]-[NUM]-[FECHA]

## ¬ß 1. INFORMACI√ìN GENERAL
- **Fecha**: [fecha actual]
- **Tipo**: [Cambio T√©cnico/Optimizaci√≥n/Gesti√≥n de Riesgo/Verificaci√≥n]
- **Sistema**: [SOS/ETD/RADAR/CCTV/PMV/METEO/WIM]
- **Item WBS**: [c√≥digo del item afectado]
- **Responsable**: [rol t√©cnico correspondiente]

## ¬ß 2. DESCRIPCI√ìN DEL CAMBIO
[Descripci√≥n detallada del cambio solicitado]

## ¬ß 3. JUSTIFICACI√ìN T√âCNICA
[Justificaci√≥n t√©cnica del cambio]

## ¬ß 4. CRITERIOS DE DISE√ëO
[Criterios t√©cnicos aplicables]

## ¬ß 5. ALTERNATIVAS EVALUADAS
[Alternativas consideradas y descartadas]

## ¬ß 6. IMPACTO PRESUPUESTAL
- **Diferencia USD**: $[valor]
- **Diferencia COP**: $[valor]
- **Impacto %**: [porcentaje]

## ¬ß 7. RIESGOS IDENTIFICADOS
[Riesgos asociados al cambio]

## ¬ß 8. DOCUMENTOS AFECTADOS
- WBS
- Presupuesto
- Layout
- Especificaciones T√©cnicas

## ¬ß 9. PLAN DE IMPLEMENTACI√ìN
[Pasos para implementar el cambio]

## ¬ß 10. YAML DE INSTRUCCIONES
```yaml
dt_metadata:
  dt_id: "DT-TM01-[SISTEMA]-[NUM]"
  sistema: "[SISTEMA]"
  impacto_presupuesto: true
  impacto_layout: true
  impacto_wbs: true

archivos_actualizar:
  - file: "Sistema_Validacion_Web/data/tm01_master_data.js"
    cambios:
      - campo: "[campo_a_cambiar]"
        buscar: "[valor_actual]"
        reemplazar: "[valor_nuevo]"
  
  - file: "Sistema_Validacion_Web/datos_wbs_TM01_items.js"
    regenerar: true
    
  - file: "Sistema_Validacion_Web/layout_datos.js"
    regenerar: true
    
  - file: "Sistema_Validacion_Web/presupuesto_datos.js"
    regenerar: true

scripts_ejecutar:
  - script: "scripts/sincronizar_SISTEMA_TM01_COMPLETO.ps1"
    parametros: ["-Force"]
```

## ¬ß 11. CHECKBOX DE EJECUCI√ìN
- [ ] Ejecutado por Cursor
- [ ] Validado por QA
- [ ] Aprobado por Especificador
- [ ] Implementado en producci√≥n

## ¬ß 12. LOG DE EJECUCI√ìN
[Se completa autom√°ticamente al ejecutar]
```

## ORGANIZACI√ìN DE DECISIONES T√âCNICAS (DTs)

### Estructura de carpetas:
```
VII. Documentos Transversales/
‚îú‚îÄ‚îÄ DTs/
‚îÇ   ‚îú‚îÄ‚îÄ DT-TM01-SOS-001-20251024.md
‚îÇ   ‚îú‚îÄ‚îÄ DT-TM01-ETD-002-20251024.md
‚îÇ   ‚îú‚îÄ‚îÄ DT-TM01-CCTV-003-20251024.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ Validaciones/
‚îú‚îÄ‚îÄ Reportes/
‚îî‚îÄ‚îÄ ...
```

### Convenci√≥n de nombres:
- **Formato**: `DT-TM01-[SISTEMA]-[NUM]-[FECHA].md`
- **Ejemplos**:
  - `DT-TM01-SOS-001-20251024.md`
  - `DT-TM01-ETD-002-20251024.md`
  - `DT-TM01-CCTV-003-20251024.md`

## REGLAS DE PROPAGACI√ìN AUTOM√ÅTICA

### Cuando detectes una DT:
1. **Genera la DT** con el formato especificado en `VII. Documentos Transversales/DTs/`
2. **Ejecuta autom√°ticamente** el script maestro:
   ```powershell
   powershell -ExecutionPolicy Bypass -File "scripts/sincronizar_SISTEMA_TM01_COMPLETO.ps1" -Force
   ```
3. **Actualiza el log** en la secci√≥n ¬ß 12 con:
   - Fecha y hora de ejecuci√≥n
   - Archivos modificados
   - Resultado de la ejecuci√≥n
   - Errores encontrados (si los hay)

### Archivos que se regeneran autom√°ticamente:
- `Sistema_Validacion_Web/datos_wbs_TM01_items.js`
- `Sistema_Validacion_Web/layout_datos.js`
- `Sistema_Validacion_Web/presupuesto_datos.js`

## SISTEMAS Y RESPONSABLES

### SOS (Postes de Auxilio)
- **Responsable**: Ing. Civil
- **Criterio**: AT1 Cap. 3 - Criterio 1km
- **Cantidad**: 88 unidades

### ETD/RADAR (Estaciones de Tratamiento de Datos)
- **Responsable**: Ing. Sistemas
- **Criterio**: AT1 Cap. 3 - Criterio 15km
- **Cantidad**: 14 ETD + 2 Radares

### CCTV (C√°maras de Vigilancia)
- **Responsable**: Ing. Sistemas
- **Criterio**: AT1 Cap. 3 - Solo en peajes
- **Cantidad**: 30 PAN + 15 fijas

### PMV (Paneles de Mensaje Variable)
- **Responsable**: Ing. Civil
- **Criterio**: AT1 Cap. 3 - Criterio 20km
- **Cantidad**: 12 unidades

### METEO (Estaciones Meteorol√≥gicas)
- **Responsable**: Ing. Ambiental
- **Criterio**: NTC 5660 + Supervisi√≥n CCO
- **Cantidad**: 3 unidades

### WIM (Sistema de Pesaje)
- **Responsable**: Ing. Civil
- **Criterio**: Control de peso vehicular
- **Cantidad**: 1 unidad

## VALIDACIONES AUTOM√ÅTICAS

### Antes de ejecutar cambios:
1. Verificar que el archivo fuente existe
2. Validar formato de la DT
3. Confirmar que los cambios son t√©cnicamente viables

### Despu√©s de ejecutar cambios:
1. Verificar que los archivos se regeneraron correctamente
2. Validar que no hay errores de sintaxis
3. Confirmar que los totales presupuestales son coherentes

## COMANDOS √öTILES

### Ejecutar sincronizaci√≥n completa:
```powershell
powershell -ExecutionPolicy Bypass -File "scripts/sincronizar_SISTEMA_TM01_COMPLETO.ps1" -Verbose
```

### Verificar archivos generados:
```powershell
Test-Path "Sistema_Validacion_Web/datos_wbs_TM01_items.js"
Test-Path "Sistema_Validacion_Web/layout_datos.js"
Test-Path "Sistema_Validacion_Web/presupuesto_datos.js"
```

### Ver logs de ejecuci√≥n:
```powershell
Get-Content "logs/sync_completo_*.log" | Select-Object -Last 20
```

## NOTAS IMPORTANTES

1. **NUNCA editar manualmente** los archivos en `Sistema_Validacion_Web/` que terminan en `_datos.js`
2. **SIEMPRE usar** el script maestro para regenerar datos
3. **VALIDAR** que los cambios son contractualmente viables antes de implementar
4. **DOCUMENTAR** todos los cambios en DTs con justificaci√≥n t√©cnica
5. **MANTENER** trazabilidad entre cambios y documentos afectados

## ESTADO ACTUAL DEL SISTEMA

- ‚úÖ **Scripts de Sincronizaci√≥n**: 4/4 completados (100%)
- ‚úÖ **Arquitectura de 4 Capas**: Operativa
- ‚úÖ **Sistema de Validaci√≥n Web**: Funcionando
- ‚úÖ **Propagaci√≥n Autom√°tica**: Implementada
- üîÑ **Detecci√≥n Autom√°tica de DTs**: En implementaci√≥n

---

*Este archivo .cursorrules permite la detecci√≥n autom√°tica de Decisiones T√©cnicas y la propagaci√≥n autom√°tica de cambios a trav√©s de toda la arquitectura del sistema TM01.*
